
<!DOCTYPE html>
<html lang='ja'>
<head>
<meta charset='utf-8'>
<link rel="shortcut icon" href="..\pic\o.ico">
<link rel='apple-touch-icon-precomposed' href='..\pic\o.png'>
<link rel='stylesheet' href='..\css\code.css'>
<title>ソースコード</title>
</head>
<body class='back'>
<h1>
ヒット　アンド　ブロー（アプリ版）
</h1>
<div class='a0'>
<a href='..\apps.html' class='a2'>
戻る
</a>
</div>
<div class='main'>
<p>
<br>import&ensp;random,&ensp;tkinter&ensp;as&ensp;t
<br>
<br>now&ensp;=&ensp;0
<br>lim&ensp;=&ensp;9
<br>col&ensp;=&ensp;4
<br>color&ensp;=&ensp;['r',&ensp;'b',&ensp;'g',&ensp;'w',&ensp;'p',&ensp;'y']
<br>iro&ensp;=&ensp;['#f87070',&ensp;'#a0f8a0',&ensp;'#a0a0f8',&ensp;'#f8f8f8',&ensp;'#f870f8',&ensp;'#f8f8a0']
<br>iro_D&ensp;=&ensp;dict()
<br>for&ensp;i&ensp;in&ensp;range(&ensp;len(color)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;iro_D[color[i]]&ensp;=&ensp;iro[i]
<br>
<br>miss0&ensp;=&ensp;['0',&ensp;'1',&ensp;'2',&ensp;'3',&ensp;'4',&ensp;'5']
<br>miss1&ensp;=&ensp;['あか',&ensp;'あお',&ensp;'みどり',&ensp;'しろ',&ensp;'ぴんく',&ensp;'き']
<br>iro_m0&ensp;=&ensp;dict()
<br>for&ensp;i&ensp;in&ensp;range(&ensp;len(color)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;iro_m0[miss0[i]]&ensp;=&ensp;color[i]
<br>iro_m1&ensp;=&ensp;dict()
<br>for&ensp;i&ensp;in&ensp;range(&ensp;len(color)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;iro_m1[miss1[i]]&ensp;=&ensp;color[i]
<br>&ensp;&ensp;&ensp;&ensp;
<br>bf&ensp;=&ensp;0&ensp;#UI配置などに使うとりあえずの変数
<br>boo&ensp;=&ensp;True
<br>
<br>#正誤判定
<br>def&ensp;hit(&ensp;a,&ensp;s&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;re&ensp;=&ensp;[0,&ensp;0]
<br>&ensp;&ensp;&ensp;&ensp;old&ensp;=&ensp;[]
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;len(s)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if(&ensp;s[i]&ensp;==&ensp;a[i]&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;re[0]&ensp;+=&ensp;1
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;old.append(&ensp;s[i]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(len(s)):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if(&ensp;(&ensp;s[i]&ensp;in&ensp;a&ensp;)&ensp;and&ensp;not&ensp;s[i]&ensp;in&ensp;old&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;re[1]&ensp;+=&ensp;1
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;old.append(&ensp;s[i]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;return&ensp;re
<br>
<br>#ランダムな数字の配列の生成
<br>def&ensp;rad(&ensp;n&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;global&ensp;color
<br>&ensp;&ensp;&ensp;&ensp;color&ensp;=&ensp;['r',&ensp;'b',&ensp;'g',&ensp;'w',&ensp;'p',&ensp;'y']
<br>&ensp;&ensp;&ensp;&ensp;return&ensp;[&ensp;color.pop(&ensp;random.randint(&ensp;0,&ensp;len(color)-1&ensp;)&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;n&ensp;)&ensp;]
<br>
<br>#colの値の桁分の答えの生成
<br>def&ensp;func():
<br>&ensp;&ensp;&ensp;&ensp;global&ensp;col
<br>&ensp;&ensp;&ensp;&ensp;return&ensp;rad(&ensp;col&ensp;)
<br>
<br>#正誤結果の処理，リスタート
<br>def&ensp;check(&ensp;event&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;global&ensp;boo,&ensp;now
<br>&ensp;&ensp;&ensp;&ensp;if&ensp;boo:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;global&ensp;inp,&ensp;col,&ensp;ans,&ensp;finalAns
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;ent&ensp;=&ensp;[&ensp;inp[now][i].get()&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;)&ensp;]
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;a&ensp;=&ensp;hit(&ensp;ans,&ensp;ent&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hitlist[now]['text']&ensp;=&ensp;str(&ensp;a[0]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;blowlist[now]['text']&ensp;=&ensp;str(&ensp;a[1]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if(&ensp;now&ensp;!=&ensp;lim&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hitlist[now+1]['background']&ensp;=&ensp;'#ffd0d0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;blowlist[now+1]['background']&ensp;=&ensp;'#ffffff'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now+1][i]['background']&ensp;=&ensp;'#ffffff'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;labCount['text']&ensp;=&ensp;'現在{}回'.format(now+1)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if(&ensp;(&ensp;now&ensp;==&ensp;lim&ensp;)&ensp;or&ensp;(&ensp;a[0]&ensp;==&ensp;col&ensp;)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;finalAns[i].insert(&ensp;0,&ensp;ans[i]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if(&ensp;a[0]&ensp;!=&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i]['background']&ensp;=&ensp;'#ffd0d0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;else:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i]['background']&ensp;=&ensp;'#d0ffff'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;submit['background']&ensp;=&ensp;'#ffd0d0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;submit['text']&ensp;=&ensp;'リスタート'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;boo&ensp;=&ensp;False
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;now&ensp;+=&ensp;1
<br>&ensp;&ensp;&ensp;&ensp;else:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;appUI()
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;now&ensp;=&ensp;0
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;labCount['text']&ensp;=&ensp;'現在{}回'.format(now+1)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;boo&ensp;=&ensp;True
<br>
<br>#入力から背景色を変更
<br>def&ensp;color_ch(&ensp;event&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;global&ensp;col,&ensp;inp,&ensp;color,&ensp;iro,&ensp;bf,&ensp;iro_D,&ensp;miss0,&ensp;miss1,&ensp;iro_m0,&ensp;iro_m1
<br>&ensp;&ensp;&ensp;&ensp;color&ensp;=&ensp;['r',&ensp;'b',&ensp;'g',&ensp;'w',&ensp;'p',&ensp;'y']
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;s&ensp;=&ensp;inp[now][i].get()
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if&ensp;s&ensp;in&ensp;miss0:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;s&ensp;=&ensp;iro_m0[s]
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i].delete(&ensp;0,&ensp;t.END&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i].insert(&ensp;0,&ensp;s&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if&ensp;s&ensp;in&ensp;miss1:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;s&ensp;=&ensp;iro_m1[s]
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i].delete(&ensp;0,&ensp;t.END&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i].insert(&ensp;0,&ensp;s&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;if&ensp;s&ensp;in&ensp;color:
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[now][i]['background']&ensp;=&ensp;iro_D[s]
<br>
<br>app&ensp;=&ensp;t.Tk()
<br>app.geometry(&ensp;'500x300'&ensp;)
<br>app.title(&ensp;'ヒットアンドブロー'&ensp;)
<br>app.resizable(&ensp;0,&ensp;0&ensp;)
<br>
<br>labs&ensp;=&ensp;[]
<br>for&ensp;i&ensp;in&ensp;range(&ensp;len(color)&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;labs.append(&ensp;t.Label(font=('Arial',&ensp;20),&ensp;relief='ridge'&ensp;)&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;labs[i]['text']&ensp;=&ensp;color[i]
<br>&ensp;&ensp;&ensp;&ensp;labs[i]['background']&ensp;=&ensp;iro[i]
<br>&ensp;&ensp;&ensp;&ensp;labs[i].place(&ensp;x=10+35*i,&ensp;y=10,&ensp;width=30,&ensp;height=35&ensp;)
<br>
<br>labCount&ensp;=&ensp;t.Label(&ensp;text=u'現在{}回'.format(now),&ensp;font=('Arial',&ensp;20)&ensp;)
<br>labCount.place(&ensp;x=220,&ensp;y=10&ensp;)
<br>labTab&ensp;=&ensp;t.Label(&ensp;text=u'[tab]で移動可',&ensp;font=('Arial',&ensp;12)&ensp;)
<br>labTab.place(&ensp;x=328,&ensp;y=15&ensp;)
<br>
<br>labHit&ensp;=&ensp;t.Label(&ensp;text=u'ヒット',&ensp;background='#ffd0d0',&ensp;font=('Arial',15)&ensp;)
<br>labHit.place(&ensp;x=10,&ensp;y=55,&ensp;width=65,&ensp;height=30&ensp;)
<br>labBlow&ensp;=&ensp;t.Label(&ensp;text=u'ブロー',&ensp;background='#ffffff',&ensp;font=('Arial',15)&ensp;)
<br>labBlow.place(&ensp;x=10,&ensp;y=90,&ensp;width=65,&ensp;height=30&ensp;)
<br>
<br>hitlist&ensp;=&ensp;[&ensp;t.Label(&ensp;text=u'&ensp;',&ensp;background='#c0c0c0',&ensp;font=('Arial',&ensp;20)&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;lim+1&ensp;)&ensp;]
<br>blowlist&ensp;=&ensp;[&ensp;t.Label(&ensp;text=u'&ensp;',&ensp;background='#c0c0c0',&ensp;font=('Arial',&ensp;20)&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;lim+1&ensp;)&ensp;]
<br>bf&ensp;=&ensp;[&ensp;hitlist[i].place(&ensp;x=80+35*i,&ensp;y=55,&ensp;width=30,&ensp;height=30&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;lim+1&ensp;)&ensp;]
<br>bf&ensp;=&ensp;[&ensp;blowlist[i].place(&ensp;x=80+35*i,&ensp;y=90,&ensp;width=30,&ensp;height=30&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;lim+1&ensp;)&ensp;]
<br>
<br>inp&ensp;=&ensp;[]
<br>
<br>labAns&ensp;=&ensp;t.Label(&ensp;text=u'答え',&ensp;font=('Arial',&ensp;12)&ensp;)
<br>labAns.place(&ensp;x=447,&ensp;y=100&ensp;)
<br>finalAns&ensp;=&ensp;[&ensp;t.Entry(&ensp;font=('Arial',&ensp;20),&ensp;justify=t.CENTER,&ensp;background='#ffffff'&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;)&ensp;]
<br>bf&ensp;=&ensp;[&ensp;finalAns[i].place(&ensp;x=450,&ensp;y=128+30*i,&ensp;width=30,&ensp;height=30&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;)&ensp;]
<br>
<br>for&ensp;j&ensp;in&ensp;range(&ensp;lim+1&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;inp.append(&ensp;[&ensp;t.Entry(&ensp;font=('Arial',&ensp;20),&ensp;justify=t.CENTER&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;)&ensp;]&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;bf&ensp;=&ensp;[&ensp;inp[j][i].place(&ensp;x=80+35*j,&ensp;y=128+30*i,&ensp;width=30,&ensp;height=30&ensp;)&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;)&ensp;]
<br>
<br>#ゲームの初期化
<br>def&ensp;appUI():
<br>&ensp;&ensp;&ensp;&ensp;global&ensp;hitlist,&ensp;blowlist,&ensp;inp,&ensp;finalAns,&ensp;bf,&ensp;submit,&ensp;ans
<br>&ensp;&ensp;&ensp;&ensp;ans&ensp;=&ensp;func()
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;j&ensp;in&ensp;range(&ensp;lim+1&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hitlist[j]['background']&ensp;=&ensp;'#c0c0c0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;blowlist[j]['background']&ensp;=&ensp;'#c0c0c0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;hitlist[j]['text']&ensp;=&ensp;''
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;blowlist[j]['text']&ensp;=&ensp;''
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[j][i]['background']&ensp;=&ensp;'#c0c0c0'
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[j][i].delete(&ensp;0,&ensp;t.END&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;finalAns[i].delete(&ensp;0,&ensp;t.END&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;hitlist[0]['background']&ensp;=&ensp;'#ffd0d0'
<br>&ensp;&ensp;&ensp;&ensp;blowlist[0]['background']&ensp;=&ensp;'#ffffff'
<br>&ensp;&ensp;&ensp;&ensp;for&ensp;i&ensp;in&ensp;range(&ensp;col&ensp;):
<br>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;inp[0][i]['background']&ensp;=&ensp;'#ffffff'
<br>&ensp;&ensp;&ensp;&ensp;submit&ensp;=&ensp;t.Button(&ensp;text=u'提出',&ensp;background='#d0d0ff',&ensp;font=('Arial',&ensp;15)&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;submit.place(&ensp;x=80,&ensp;y=255,&ensp;width=346,&ensp;height=35&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;submit.bind(&ensp;'&lt;Button-1&gt;',&ensp;check&ensp;)
<br>&ensp;&ensp;&ensp;&ensp;
<br>&ensp;&ensp;&ensp;&ensp;#print(ans)&ensp;#デバッグ用，答えの出力
<br>
<br>appUI()
<br>
<br>app.bind(&ensp;'&lt;Key&gt;',&ensp;color_ch&ensp;)
<br>app.bind(&ensp;'&lt;Return&gt;',&ensp;check&ensp;)
<br>
<br>app.mainloop()
<br>

</p>
</div>
<script src='../count/count.php'></script>
</body>
</html>
